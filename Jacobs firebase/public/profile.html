<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Profile â€” Arena Battlegrounds</title>
    <link href="css/styles.css" rel="stylesheet">
  </head>

  <body>
    <nav class="navbar">
      <div class="nav-logo">Arena Battlegrounds</div>
      <div class="user" id="user"> Not Signed In </div>

      <ul class="nav-links">
        <li><a href="battle.html">Battle</a></li>
        <li><a href="rankings.html">Rankings</a></li>
        <li><a href="profile.html">Profile</a></li>
        <li><a href="index.html">Login / Signup</a></li>
      </ul>
    </nav>

    <main style="padding:20px; max-width:900px; margin:0 auto;">
      <h1>Profile</h1>

      <section id="stats" style="margin-bottom:16px;">
        <div><strong>Display name:</strong> <span id="profile-name">(not signed in)</span></div>
        <div><strong>Selected class:</strong> <span id="profile-selected-class">(none)</span></div>
        <div style="margin-top:8px;"><strong>Wins:</strong> <span id="profile-wins">0</span> &nbsp; <strong>Losses:</strong> <span id="profile-losses">0</span></div>
      </section>

      <section id="played-classes" style="margin-bottom:16px;">
        <h3>Played classes (recent)</h3>
        <div id="played-classes-list">(loading...)</div>
      </section>

      <section id="inventory-section">
        <h3>Your Inventory</h3>
        <div id="profile-inventory">(loading...)</div>
        <div style="margin-top:8px;">
        </div>
      </section>
    </main>

    <script type="module">
      // Bootstrap firebase globals and redirect unauthenticated users to the login page
      try {
        import('./js/firebase.js').then(({ auth, db }) => {
          Promise.all([
            import('https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js'),
            import('https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js')
          ]).then(([dbMod, authMod]) => {
            try {
              const { ref, get, update } = dbMod;
              const { onAuthStateChanged } = authMod;
              window.db = db;
              window.ref = ref;
              window.get = get;
              window.update = update;
              window.auth = auth;
              onAuthStateChanged(auth, (user) => { window.currentUserUid = user ? user.uid : null; if (!user) { try { window.location.href = 'index.html'; } catch(e){} } });
              console.debug('[profile] firebase bootstrap complete');
            } catch (e) { console.warn('[profile] firebase bootstrap failed', e); }
          }).catch(e => console.warn('[profile] import error', e));
        }).catch(e => console.warn('[profile] could not import firebase module', e));
      } catch (e) { console.warn('[profile] bootstrap error', e); }
    </script>
    <script type="module" src="js/app.js"></script>
    <script type="module" src="js/profile.js"></script>
  </body>
</html>
